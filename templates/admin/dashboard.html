{% extends "base.html" %}

{% block title %}Admin Dashboard - CCI{% endblock %}

{% block content %}
<!-- Admin Header -->
<div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold">Admin Dashboard</h1>
                <p class="text-blue-200 mt-2">Welcome back, Administrator</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="text-sm text-blue-200">Last login</p>
                    <p class="text-white font-semibold">{{ current_time.strftime('%b %d, %Y %H:%M') }}</p>
                </div>
                <a href="{{ url_for('logout') }}" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Dashboard Stats -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
        <!-- Total Tenders Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover" data-aos="fade-up" data-aos-delay="100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Total Tenders</p>
                    <p class="text-3xl font-bold text-blue-600">{{ total_tenders }}</p>
                </div>
                <div class="bg-blue-100 p-3 rounded-full">
                    <i class="fas fa-file-contract text-blue-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4">
                <a href="{{ url_for('admin_tenders') }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                    View All <i class="fas fa-arrow-right ml-1"></i>
                </a>
            </div>
        </div>

        <!-- Total Messages Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover" data-aos="fade-up" data-aos-delay="200">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Total Messages</p>
                    <p class="text-3xl font-bold text-green-600">{{ total_messages }}</p>
                </div>
                <div class="bg-green-100 p-3 rounded-full">
                    <i class="fas fa-envelope text-green-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4">
                <a href="{{ url_for('admin_messages') }}" class="text-green-600 hover:text-green-800 text-sm font-medium">
                    View All <i class="fas fa-arrow-right ml-1"></i>
                </a>
            </div>
        </div>

        <!-- Unread Messages Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover" data-aos="fade-up" data-aos-delay="300">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Unread Messages</p>
                    <p class="text-3xl font-bold text-orange-600">{{ unread_messages }}</p>
                </div>
                <div class="bg-orange-100 p-3 rounded-full">
                    <i class="fas fa-bell text-orange-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4">
                <span class="text-orange-600 text-sm font-medium">
                    {% if unread_messages > 0 %}
                        Requires Attention
                    {% else %}
                        All Caught Up!
                    {% endif %}
                </span>
            </div>
        </div>

        <!-- Total News Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover" data-aos="fade-up" data-aos-delay="350">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">News Updates</p>
                    <p class="text-3xl font-bold text-indigo-600">{{ total_news }}</p>
                </div>
                <div class="bg-indigo-100 p-3 rounded-full">
                    <i class="fas fa-newspaper text-indigo-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4">
                <a href="{{ url_for('admin_news') }}" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                    Manage News <i class="fas fa-arrow-right ml-1"></i>
                </a>
            </div>
        </div>

        <!-- Total Users Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover" data-aos="fade-up" data-aos-delay="400">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Total Users</p>
                    <p class="text-3xl font-bold text-purple-600">{{ total_users }}</p>
                </div>
                <div class="bg-purple-100 p-3 rounded-full">
                    <i class="fas fa-users text-purple-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4">
                <a href="{{ url_for('admin_users') }}" class="text-purple-600 hover:text-purple-800 text-sm font-medium">
                    View All <i class="fas fa-arrow-right ml-1"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8" data-aos="fade-up" data-aos-delay="500">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Quick Actions</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <a href="{{ url_for('admin_tenders') }}" class="bg-blue-50 hover:bg-blue-100 p-4 rounded-lg transition-colors group">
                <div class="flex items-center space-x-3">
                    <div class="bg-blue-600 p-2 rounded-lg group-hover:bg-blue-700 transition-colors">
                        <i class="fas fa-file-contract text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Manage Tenders</h3>
                        <p class="text-sm text-gray-600">Add or edit tender postings</p>
                    </div>
                </div>
            </a>

            <a href="{{ url_for('admin_messages') }}" class="bg-green-50 hover:bg-green-100 p-4 rounded-lg transition-colors group">
                <div class="flex items-center space-x-3">
                    <div class="bg-green-600 p-2 rounded-lg group-hover:bg-green-700 transition-colors">
                        <i class="fas fa-envelope text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Review Messages</h3>
                        <p class="text-sm text-gray-600">Check contact messages</p>
                    </div>
                </div>
            </a>

            <a href="{{ url_for('admin_news') }}" class="bg-indigo-50 hover:bg-indigo-100 p-4 rounded-lg transition-colors group">
                <div class="flex items-center space-x-3">
                    <div class="bg-indigo-600 p-2 rounded-lg group-hover:bg-indigo-700 transition-colors">
                        <i class="fas fa-newspaper text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Manage News</h3>
                        <p class="text-sm text-gray-600">Add or edit news updates</p>
                    </div>
                </div>
            </a>

            <a href="{{ url_for('admin_users') }}" class="bg-purple-50 hover:bg-purple-100 p-4 rounded-lg transition-colors group">
                <div class="flex items-center space-x-3">
                    <div class="bg-purple-600 p-2 rounded-lg group-hover:bg-purple-700 transition-colors">
                        <i class="fas fa-users text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Manage Users</h3>
                        <p class="text-sm text-gray-600">View and manage user accounts</p>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Recent Tenders -->
        <div class="bg-white rounded-xl shadow-lg p-6" data-aos="fade-up" data-aos-delay="600">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">Recent Tenders</h2>
                <a href="{{ url_for('admin_tenders') }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                    View All
                </a>
            </div>
            <div class="space-y-4">
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                    <h3 class="font-semibold text-gray-800">Supply of Raw Materials</h3>
                    <p class="text-sm text-gray-600">Tender No: CCI/2024/001</p>
                    <p class="text-xs text-gray-500 mt-1">Status: Open</p>
                </div>
                <div class="border-l-4 border-green-500 pl-4 py-2">
                    <h3 class="font-semibold text-gray-800">Equipment Maintenance</h3>
                    <p class="text-sm text-gray-600">Tender No: CCI/2024/002</p>
                    <p class="text-xs text-gray-500 mt-1">Status: Open</p>
                </div>
                <div class="border-l-4 border-orange-500 pl-4 py-2">
                    <h3 class="font-semibold text-gray-800">Transportation Services</h3>
                    <p class="text-sm text-gray-600">Tender No: CCI/2024/003</p>
                    <p class="text-xs text-gray-500 mt-1">Status: Closed</p>
                </div>
            </div>
        </div>

        <!-- Recent News -->
        <div class="bg-white rounded-xl shadow-lg p-6" data-aos="fade-up" data-aos-delay="650">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">Recent News</h2>
                <div class="flex space-x-2">
                    <a href="{{ url_for('add_news') }}" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                        <i class="fas fa-plus mr-1"></i>Add New
                    </a>
                    <a href="{{ url_for('admin_news') }}" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                        View All
                    </a>
                </div>
            </div>
            <div class="space-y-4">
                {% if total_news > 0 %}
                    <div class="border-l-4 border-indigo-500 pl-4 py-2">
                        <h3 class="font-semibold text-gray-800">Latest News Updates</h3>
                        <p class="text-sm text-gray-600">{{ total_news }} news articles published</p>
                        <p class="text-xs text-gray-500 mt-1">Keep stakeholders informed</p>
                    </div>
                {% else %}
                    <div class="border-l-4 border-gray-300 pl-4 py-2">
                        <h3 class="font-semibold text-gray-800">No News Yet</h3>
                        <p class="text-sm text-gray-600">Start by adding your first news update</p>
                        <a href="{{ url_for('add_news') }}" class="text-indigo-600 hover:text-indigo-800 text-xs font-medium mt-1 inline-block">
                            Add News <i class="fas fa-plus ml-1"></i>
                        </a>
                    </div>
                {% endif %}
                
                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg border border-indigo-200">
                    <div class="flex items-center space-x-3">
                        <div class="bg-indigo-600 p-2 rounded-lg">
                            <i class="fas fa-lightbulb text-white text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">News Management Tips</h3>
                            <p class="text-sm text-gray-600">Keep news fresh and engaging</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Messages -->
        <div class="bg-white rounded-xl shadow-lg p-6" data-aos="fade-up" data-aos-delay="700">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">Recent Messages</h2>
                <a href="{{ url_for('admin_messages') }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                    View All
                </a>
            </div>
            <div class="space-y-4">
                {% if unread_messages > 0 %}
                    <div class="flex items-start space-x-3 p-3 bg-red-50 rounded-lg border border-red-200">
                        <div class="bg-red-600 p-2 rounded-full">
                            <i class="fas fa-envelope text-white text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-800">New Messages</h3>
                            <p class="text-sm text-gray-600">{{ unread_messages }} unread message{{ 's' if unread_messages != 1 else '' }}</p>
                            <p class="text-xs text-gray-500 mt-1">Click to review</p>
                        </div>
                        <span class="bg-red-500 text-white text-xs px-2 py-1 rounded-full">{{ unread_messages }}</span>
                    </div>
                {% else %}
                    <div class="flex items-start space-x-3 p-3 bg-green-50 rounded-lg border border-green-200">
                        <div class="bg-green-600 p-2 rounded-full">
                            <i class="fas fa-check text-white text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-800">All Caught Up!</h3>
                            <p class="text-sm text-gray-600">No unread messages</p>
                            <p class="text-xs text-gray-500 mt-1">Great job staying on top of communications</p>
                        </div>
                    </div>
                {% endif %}
                
                <div class="text-center py-4">
                    <a href="{{ url_for('admin_messages') }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                        View All Messages <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Management Actions -->
    <div class="mt-8 bg-white rounded-xl shadow-lg p-6" data-aos="fade-up" data-aos-delay="750">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Content Management</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-blue-600 p-3 rounded-lg">
                        <i class="fas fa-file-contract text-white text-xl"></i>
                    </div>
                    <span class="bg-blue-600 text-white text-sm px-3 py-1 rounded-full">{{ total_tenders }}</span>
                </div>
                <h3 class="font-semibold text-gray-800 mb-2">Tender Management</h3>
                <p class="text-sm text-gray-600 mb-4">Manage tender postings and applications</p>
                <a href="{{ url_for('admin_tenders') }}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    Manage Tenders
                </a>
            </div>

            <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-lg border border-indigo-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-indigo-600 p-3 rounded-lg">
                        <i class="fas fa-newspaper text-white text-xl"></i>
                    </div>
                    <span class="bg-indigo-600 text-white text-sm px-3 py-1 rounded-full">{{ total_news }}</span>
                </div>
                <h3 class="font-semibold text-gray-800 mb-2">News & Updates</h3>
                <p class="text-sm text-gray-600 mb-4">Create and manage news articles</p>
                <div class="flex space-x-2">
                    <a href="{{ url_for('add_news') }}" class="bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors">
                        Add News
                    </a>
                    <a href="{{ url_for('admin_news') }}" class="bg-indigo-100 hover:bg-indigo-200 text-indigo-700 px-3 py-2 rounded-lg text-sm font-medium transition-colors">
                        View All
                    </a>
                </div>
            </div>

            <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-green-600 p-3 rounded-lg">
                        <i class="fas fa-envelope text-white text-xl"></i>
                    </div>
                    <span class="bg-green-600 text-white text-sm px-3 py-1 rounded-full">{{ unread_messages }}</span>
                </div>
                <h3 class="font-semibold text-gray-800 mb-2">Message Center</h3>
                <p class="text-sm text-gray-600 mb-4">Review and respond to inquiries</p>
                <a href="{{ url_for('admin_messages') }}" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    Check Messages
                </a>
            </div>
        </div>
    </div>

    <!-- System Information -->
    <div class="mt-8 bg-white rounded-xl shadow-lg p-6" data-aos="fade-up" data-aos-delay="800">
        <h2 class="text-xl font-bold text-gray-800 mb-6">System Information</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="text-center">
                <div class="bg-blue-100 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-database text-blue-600 text-2xl"></i>
                </div>
                <h3 class="font-semibold text-gray-800">Database Status</h3>
                <p class="text-sm text-green-600 mt-1">
                    <i class="fas fa-check-circle mr-1"></i>Healthy
                </p>
            </div>
            <div class="text-center">
                <div class="bg-green-100 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-shield-alt text-green-600 text-2xl"></i>
                </div>
                <h3 class="font-semibold text-gray-800">Security Status</h3>
                <p class="text-sm text-green-600 mt-1">
                    <i class="fas fa-check-circle mr-1"></i>Secure
                </p>
            </div>
            <div class="text-center">
                <div class="bg-purple-100 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-clock text-purple-600 text-2xl"></i>
                </div>
                <h3 class="font-semibold text-gray-800">Server Uptime</h3>
                <p class="text-sm text-gray-600 mt-1">
                    <i class="fas fa-info-circle mr-1"></i>Running
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Dashboard-specific JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        // Animate counter numbers
        const counters = document.querySelectorAll('.text-3xl.font-bold');
        counters.forEach(counter => {
            const target = parseInt(counter.textContent);
            if (isNaN(target)) return;
            
            let current = 0;
            const increment = target / 50;
            
            const updateCounter = () => {
                if (current < target) {
                    current += increment;
                    counter.textContent = Math.floor(current);
                    setTimeout(updateCounter, 20);
                } else {
                    counter.textContent = target;
                }
            };
            
            // Start animation after a delay
            setTimeout(updateCounter, 500);
        });
        
        // Add hover effects to cards
        const cards = document.querySelectorAll('.card-hover');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
                this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
            });
        });
        
        // Add smooth scrolling for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Auto-refresh notification for new messages
        setInterval(() => {
            // You can add auto-refresh logic here
            console.log('Dashboard checking for updates...');
        }, 300000); // Check every 5 minutes
    });
</script>
{% endblock %}